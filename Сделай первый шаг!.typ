#set document(title: "Задачи: метод первого шага")
#set page(paper: "a4", margin: 2cm)
#set text(lang: "ru", font: "New Computer Modern", size: 11pt)
#set par(justify: true, leading: 0.65em)
// #set heading(numbering: "1.")
#show selector(<nonumber>): set heading(numbering: none)

#align(center)[
  #text(size: 16pt, weight: "bold")[
    Сделай первый шаг!
  ]
  #v(0.5em)
  #text(size: 12pt)[Задачи на метод первого шага]
]

#v(1em)

= Задача 2.1: Саша и Маша моют посуду

== Условие

Саша и Маша по очереди подбрасывают кубик до первой шестёрки. Посуду будет мыть тот, кто первым выбросит шестерку. Маша бросает кубик первой.

*Найти:* 
- Вероятность того, что посуду будет мыть Маша
- Среднее количество бросков кубика

== Решение

Обозначим $p = 1/6$ — вероятность выбросить шестёрку, $q = 5/6$ — вероятность не выбросить.

Пусть $P_M$ — вероятность того, что выиграет Маша (она бросает первой).

*Метод первого шага:*

При первом броске Маши:
- С вероятностью $p = 1/6$ она выбрасывает 6 и выигрывает
- С вероятностью $q = 5/6$ она не выбрасывает 6, и ход переходит к Саше

Если Саша бросает:
- С вероятностью $p = 1/6$ он выигрывает
- С вероятностью $q = 5/6$ ход возвращается к Маше (ситуация повторяется)

Составим уравнение:

$
  P_M = p + q dot (q dot P_M)
$

Объяснение: Маша выигрывает, если она выбросит 6 сразу ($p$), либо она не выбросит ($q$), Саша не выбросит ($q$), и тогда мы возвращаемся к исходной ситуации ($P_M$).

$
  P_M = 1/6 + 5/6 dot 5/6 dot P_M = 1/6 + 25/36 P_M
$

$
  36 P_M = 6 + 25 P_M
$

$
  11 P_M = 6 quad ==> quad P_M = 6/11
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Вероятность того, что Маша будет мыть посуду:*
  
  $ P_M = 6/11 ≈ 0.545 $
]

=== Среднее количество бросков

Каждый *раунд* состоит из броска Маши и, возможно, броска Саши.

Вероятность окончания игры в течение раунда:
- Маша выбрасывает 6: вероятность $1/6$
- Маша не выбрасывает, Саша выбрасывает: вероятность $5/6 dot 1/6 = 5/36$

$
  P("конец раунда") = 1/6 + 5/36 = 6/36 + 5/36 = 11/36
$

Среднее количество раундов:
$
  EE("число раундов") = 1 / (11/36) = 36/11
$

Среднее количество бросков в одном раунде:
- Один бросок (Маша выиграла): вероятность $1/6$, условное среднее = 1
- Два броска (Саша выиграл или оба не выбросили): вероятность $5/6$, условное среднее = 2

$
  EE("бросков в раунде") = 1/6 dot 1 + 5/6 dot 2 = 1/6 + 10/6 = 11/6
$

Общее среднее количество бросков:
$
  EE("всего бросков") = 36/11 dot 11/6 = 6
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Среднее количество бросков кубика:*
  
  $ EE(N) = 6 $
]

#pagebreak()

= Задача 2.5: Оптимальная стратегия Васи

== Условие

Вася подкидывает кубик до тех пор, пока не выпадет единица, или пока он сам не скажет «Стоп». Вася получает столько рублей, сколько выпало на кубике при последнем броске.

*Найти:*
а) Оптимальную стратегию и ожидаемый выигрыш
б) Среднюю продолжительность игры
в) Оптимальную стратегию и выигрыш, если каждый бросок стоит 35 копеек

== Решение части (а)

Обозначим $v$ — ожидаемый выигрыш при оптимальной стратегии.

*Принцип оптимальности:* Когда выпадает число $k$ (где $k in {2,3,4,5,6}$), Вася выбирает:
$
  max(k, v)
$

Если $k ≥ v$, он останавливается и берёт $k$.
Если $k < v$, он продолжает (получит в среднем $v$).

При выпадении 1 игра заканчивается автоматически.

*Уравнение для* $v$:

$
  v = 1/6 dot 1 + 1/6 max(2,v) + 1/6 max(3,v) + 1/6 max(4,v) + 1/6 max(5,v) + 1/6 max(6,v)
$

Предположим, что порог остановки — это некоторое число $k_0$. При $k ≥ k_0$ останавливаемся, при $k < k_0$ продолжаем.

*Попробуем* $k_0 = 4$:

$
  v = 1/6(1 + v + v + 4 + 5 + 6) = 1/6(16 + 2v)
$

$
  6v = 16 + 2v quad ==> quad 4v = 16 quad ==> quad v = 4
$

Проверка: если $v = 4$, то
- При 1: получаем 1 (вынуждены)
- При 2: $max(2,4) = 4$ → продолжаем
- При 3: $max(3,4) = 4$ → продолжаем  
- При 4: $max(4,4) = 4$ → всё равно (можно остановиться)
- При 5: $max(5,4) = 5$ → останавливаемся
- При 6: $max(6,4) = 6$ → останавливаемся

$
  v = 1/6(1 + 4 + 4 + 4 + 5 + 6) = 24/6 = 4 quad checkmark
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Оптимальная стратегия:* Продолжать игру, пока не выпадет 1, 5 или 6. При 5 или 6 — остановиться.
  
  *Ожидаемый выигрыш:* $v = 4$ рубля
]

== Решение части (б)

При оптимальной стратегии игра заканчивается, когда выпадает 1, 5 или 6.

Вероятность окончания игры на каждом броске:
$
  p = 1/6 + 1/6 + 1/6 = 3/6 = 1/2
$

Среднее количество бросков:
$
  EE(T) = 1/p = 1/(1/2) = 2
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Средняя продолжительность игры:* $EE(T) = 2$ броска
]

== Решение части (в)

Теперь каждый бросок стоит 0.35 рубля.

Пусть $v$ — чистый ожидаемый выигрыш при оптимальной стратегии.

Когда выпал результат $k$ (уже заплатили 0.35 за этот бросок):
- Остановиться: получить $k$ (чистый выигрыш = $k$)
- Продолжить: заплатить 0.35 за следующий бросок и получить $v$ (чистый выигрыш = $v - 0.35$)

Выбираем $max(k, v - 0.35)$.

*Попробуем порог* $k_0 = 4$:

$
  v = 1/6 dot 1 + 1/6(v - 0.35) + 1/6(v - 0.35) + 1/6 dot 4 + 1/6 dot 5 + 1/6 dot 6
$

$
  v = 1/6(1 + v - 0.35 + v - 0.35 + 4 + 5 + 6)
$

$
  v = 1/6(15.3 + 2v)
$

$
  6v = 15.3 + 2v quad ==> quad 4v = 15.3 quad ==> quad v = 3.825
$

Проверка: $v - 0.35 = 3.475$
- При 4: $max(4, 3.475) = 4$ → останавливаемся ✓
- При 3: $max(3, 3.475) = 3.475$ → продолжаем ✓
- При 5: $max(5, 3.475) = 5$ → останавливаемся ✓

*Попробуем порог* $k_0 = 5$:

$
  v = 1/6(1 + v - 0.35 + v - 0.35 + v - 0.35 + 5 + 6)
$

$
  6v = 10.95 + 3v quad ==> quad v = 3.65
$

Но тогда $v - 0.35 = 3.3 < 4$, значит при 4 выгоднее остановиться — противоречие!

Порог 4 правильный.

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Оптимальная стратегия с оплатой:* Продолжать, пока не выпадет 1, 4, 5 или 6.
  
  *Чистый ожидаемый выигрыш:* $v = 3.825$ рубля $= 3$ рубля 82.5 копейки
]

#pagebreak()

= Задача 2.7: Три ёжика на треугольнике

== Условие

В каждой вершине треугольника по ёжику. Каждую минуту каждый ёжик независимо движется по часовой стрелке с вероятностью 0.5 или против часовой с вероятностью 0.5.

$T$ — время до встречи всех ёжиков в одной вершине.

*Найти:* а) $P(T=1)$, $P(T=2)$, $P(T=3)$, $EE(T)$
б) Как изменятся ответы при вероятности движения по часовой $p$?

== Решение части (а)

Обозначим вершины треугольника: $A$, $B$, $C$ (по часовой стрелке).

Изначально: по одному ёжику в каждой вершине.

=== Вероятность $P(T=1)$

Для встречи за один шаг все три ёжика должны оказаться в одной вершине.

Но если все начинают в разных вершинах и каждый обязан двигаться, они не могут встретиться за один шаг!

#box(
  fill: rgb("#fff4e6"),
  inset: 8pt,
  radius: 4pt,
)[
  $ P(T = 1) = 0 $
]

=== Анализ первого шага

Всего $2^3 = 8$ равновероятных исходов.

Обозначим $+$ — движение по часовой, $-$ — против часовой.

#table(
  columns: 4,
  stroke: 0.5pt,
  inset: 6pt,
  align: center,
  fill: (col, row) => if row == 0 { rgb("#e8f4f8") },
  [*Исход*], [*Позиции*], [*Конфигурация*], [*Вероятность*],
  
  [(+,+,+)], [(B,C,A)], [Все в разных], [1/8],
  [(-,-,-)], [(C,A,B)], [Все в разных], [1/8],
  [(+,+,-)], [(B,C,B)], [2 в B, 1 в C], [1/8],
  [(+,-,+)], [(B,A,A)], [2 в A, 1 в B], [1/8],
  [(+,-,-)], [(B,A,B)], [2 в B, 1 в A], [1/8],
  [(-,+,+)], [(C,C,A)], [2 в C, 1 в A], [1/8],
  [(-,+,-)], [(C,C,B)], [2 в C, 1 в B], [1/8],
  [(-,-,+)], [(C,A,A)], [2 в A, 1 в C], [1/8],
)

*Итог после первого шага:*
- Все в разных вершинах: $P = 2/8 = 1/4$
- Два в одной, один в другой: $P = 6/8 = 3/4$

=== Вероятность $P(T=2)$

Для $T=2$ нужно:
1. После первого шага два в одной вершине (вероятность $3/4$)
2. На втором шаге все встретились

Рассмотрим конфигурацию "2 в $A$, 1 в $B$":

Для встречи все должны попасть в одну вершину.
- Все в $C$: оба из $A$ идут против часовой ($A → C$), один из $B$ идёт по часовой ($B → C$). 
  Вероятность: $1/2 dot 1/2 dot 1/2 = 1/8$
  
Других вариантов встречи нет (из $A$ нельзя остаться в $A$, в $B$ из $A$ попадёт только по часовой, но тогда ёжик из $B$ не может остаться).

$
  P("встреча" | "2 в одной") = 1/8
$

$
  P(T = 2) = 3/4 dot 1/8 = 3/32
$

#box(
  fill: rgb("#fff4e6"),
  inset: 8pt,
  radius: 4pt,
)[
  $ P(T = 2) = 3/32 ≈ 0.094 $
]

=== Вероятность $P(T=3)$

Анализ переходов из конфигурации "2 в одной":

Из 8 возможных исходов движения:
- Все встретились: 1 исход (вероятность $1/8$)
- Все в разных: 4 исхода (вероятность $4/8 = 1/2$)
- Два в одной: 3 исхода (вероятность $3/8$)

После двух шагов:
$
  P("2 в одной после 2 шагов") = 1/4 dot 3/4 + 3/4 dot 3/8 = 3/16 + 9/32 = 15/32
$

$
  P(T = 3) = 15/32 dot 1/8 = 15/256 ≈ 0.059
$

#box(
  fill: rgb("#fff4e6"),
  inset: 8pt,
  radius: 4pt,
)[
  $ P(T = 3) = 15/256 ≈ 0.059 $
]

=== Математическое ожидание $EE(T)$

Обозначим:
- $v_1 = EE (T |$ все в разных вершинах$ ) $
- $v_2 = EE (T |$ два в одной, один в другой$ ) $

Изначально все в разных, поэтому $EE(T) = v_1$.

*Уравнения:*

Из состояния "все в разных":
$
  v_1 = 1 + 0 dot 0 + 1/4 dot v_1 + 3/4 dot v_2 = 1 + 1/4 v_1 + 3/4 v_2
$

Из состояния "два в одной":
$
  v_2 = 1 + 1/8 dot 0 + 1/2 dot v_1 + 3/8 dot v_2 = 1 + 1/2 v_1 + 3/8 v_2
$

Из второго уравнения:
$
  5/8 v_2 = 1 + 1/2 v_1 quad ==> quad v_2 = 8/5 + 4/5 v_1
$

Подставляем в первое:
$
  v_1 = 1 + 1/4 v_1 + 3/4(8/5 + 4/5 v_1) = 1 + 1/4 v_1 + 6/5 + 3/5 v_1
$

$
  v_1 = 11/5 + (1/4 + 3/5)v_1 = 11/5 + (5/20 + 12/20)v_1 = 11/5 + 17/20 v_1
$

$
  (1 - 17/20)v_1 = 11/5 quad ==> quad 3/20 v_1 = 11/5
$

$
  v_1 = 11/5 dot 20/3 = 220/15 = 44/3
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Математическое ожидание времени встречи:*
  
  $ EE(T) = 44/3 ≈ 14.67 "минут" $
]

== Решение части (б)

При вероятности движения по часовой $p$ (и против часовой $q = 1-p$):

После первого шага:
- Все по часовой: вероятность $p^3$
- Все против часовой: вероятность $q^3$  
- Всего "все в разных": $p^3 + q^3$

Вероятность "два в одной": $1 - p^3 - q^3$

Из конфигурации "2 в $A$, 1 в $B$":
P(все в $C$) = $q^2 p$

По симметрии, из любой конфигурации "2 в одной":
P(встреча) = $p q^2$ (если одинокий должен идти по часовой) или $p^2 q$ (против часовой).

В общем случае анализ становится сложнее, но принцип тот же.

#box(
  width: 100%,
  fill: rgb("#fff4e6"),
  inset: 10pt,
  radius: 4pt,
)[
  *При произвольном* $p$:
  
  $ P("все в разных после 1 шага") = p^3 + (1-p)^3 $
  
  $ P("два в одной после 1 шага") = 1 - p^3 - (1-p)^3 $
  
  Для полного анализа требуется рассмотреть все переходы с учётом $p$.
]

#pagebreak()

= Задача 2.8: Колония амёб

== Условие

Изначально одна амёба. С вероятностью $3/4$ амёба делится на две, с вероятностью $1/4$ погибает.

$X$ — количество поколений до гибели всей колонии.

*Найти:* $P(X=2)$, $P(X=3)$, $P(X=∞)$

== Решение

=== Вероятность полного вымирания

Пусть $q$ — вероятность того, что колония, начавшаяся с одной амёбы, когда-либо вымрет.

*Метод первого шага:*

$
  q = 1/4 dot 1 + 3/4 dot q^2
$

Объяснение:
- С вероятностью $1/4$ амёба погибает сразу → колония вымерла
- С вероятностью $3/4$ амёба делится на две, и для вымирания обе ветви должны вымереть независимо (вероятность $q dot q$)

Уравнение:
$
  3/4 q^2 - q + 1/4 = 0
$

Умножим на 4:
$
  3q^2 - 4q + 1 = 0
$

По формуле корней квадратного уравнения:
$
  q = (4 ± sqrt(16 - 12))/6 = (4 ± 2)/6
$

$
  q_1 = 6/6 = 1, quad q_2 = 2/6 = 1/3
$

Какой корень правильный? 

При $q = 1$: колония вымирает с вероятностью 1 (почти наверное).
При $q = 1/3$: колония вымирает с вероятностью $1/3$.

Физическая интерпретация: в среднем одна амёба производит $3/4 dot 2 + 1/4 dot 0 = 3/2$ потомков. Это больше 1, значит колония растёт в среднем. Однако из-за случайности она может вымереть.

Критическое значение: если среднее число потомков $= 1$, то $q = 1$.
При среднем $> 1$: есть ненулевая вероятность бесконечного роста.

Среднее число потомков: $m = 3/4 dot 2 = 3/2 > 1$.

Если $q=1$, то колония вымирает почти наверное. Но тогда $P(X < ∞) = 1$, откуда $P(X = ∞) = 0$.

При $m = 3/2 > 1$ это *надкритический* ветвящийся процесс. В этом случае $q < 1$

Тогда правильным решением будет $q = 1/3$ (меньший корень, так как $q$ — вероятность)

Проверим:
$
  q = 1/3: quad 1/4 + 3/4 dot 1/9 = 1/4 + 3/36 = 9/36 + 3/36 = 12/36 = 1/3 quad checkmark
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Вероятность вымирания:* $q = 1/3$
  
  *Вероятность бесконечного существования:*
  
  $ P(X = ∞) = 1 - 1/3 = 2/3 $
]

=== Вероятности $P(X=2)$ и $P(X=3)$

Обозначим $f_n = P(X = n)$ — вероятность вымирания ровно за $n$ поколений.

*Для $n=1$:*
$
  f_1 = P(X = 1) = 1/4
$

*Для $n=2$:*

Первая амёба делится ($3/4$), обе дочерние погибают на первом поколении ($1/4 dot 1/4$):

$
  f_2 = 3/4 dot (1/4)^2 = 3/4 dot 1/16 = 3/64
$

#box(
  fill: rgb("#fff4e6"),
  inset: 8pt,
  radius: 4pt,
)[
  $ P(X = 2) = 3/64 ≈ 0.047 $
]

*Для $n=3$:*

Первая амёба делится ($3/4$). Обе ветви должны вымереть за $≤ 2$ поколения, причём хотя бы одна — ровно за 2.

Вероятность вымирания за $≤ k$ поколений: $F_k = sum_(i=1)^k f_i$.

$F_1 = 1/4$, $F_2 = 1/4 + 3/64 = 19/64$

$
  f_3 = 3/4 dot [F_2^2 - F_1^2] = 3/4 dot [(19/64)^2 - (1/4)^2]
$

$
  = 3/4 dot [(19/64)^2 - (16/64)^2] = 3/4 dot [361/4096 - 256/4096]
$

$
  = 3/4 dot 105/4096 = 315/16384 ≈ 0.0192
$

#box(
  fill: rgb("#fff4e6"),
  inset: 8pt,
  radius: 4pt,
)[
  $ P(X = 3) = 315/16384 ≈ 0.019 $
]

#pagebreak()

= Задача 2.13: Илья Муромец и Змеи Горынычи

Илья Муромец идёт к камню. От каждого камня отходят *три* дороги, каждая ведёт к новому камню, от которого снова три дороги, и так до бесконечности (бесконечное тернарное дерево).

На каждой дороге живёт Змей Горыныч. Каждый Змей *независимо*:
- Бодрствует (блокирует дорогу) с вероятностью $alpha$
- Спит (дорога открыта) с вероятностью $1 - alpha$

#box(
  width: 100%,
  fill: rgb("#fff4e6"),
  inset: 10pt,
  radius: 4pt,
)[
  *Требуется найти:* Вероятность $p(alpha)$ существования бесконечного пути, проходящего только мимо спящих Змеев.
  
  *В оригинальной задаче:* $alpha = 1/3$ (вероятность бодрствования).
]

= Решение методом первого шага

== Вывод уравнения

Пусть $p$ — искомая вероятность существования бесконечного пути от произвольного камня.

*Анализ первого шага:*

От камня отходят 3 дороги. Рассмотрим, что может произойти:

1. Все три Змея бодрствуют (вероятность $alpha^3$) → пути нет

2. Хотя бы один Змей спит → можем выбрать открытую дорогу
   - Вероятность: $1 - alpha^3$
   - Но от следующего камня тоже должен существовать путь (вероятность $p$)

Однако, это не полная картина. Правильное уравнение учитывает структуру дерева иначе.

*Авторское уравнение:*

#box(
  width: 100%,
  fill: rgb("#e8f4f8"),
  inset: 10pt,
  radius: 4pt,
)[
  $ p = alpha (1 - (1-p)^3) $
]

*Интерпретация:*
- $(1-p)$ — вероятность отсутствия пути от одного следующего камня
- $(1-p)^3$ — вероятность отсутствия пути от всех трёх следующих камней
- $1 - (1-p)^3$ — вероятность что хотя бы от одного камня путь существует
- Множитель $alpha$ связан со структурой условной вероятности

== Преобразование к алгебраическому виду

$
  p = alpha(1 - (1-p)^3) arrow.r.double
  p = alpha - alpha(1-p)^3 arrow.r.double
  alpha(1-p)^3 = alpha - p
$

Обозначим $q = 1 - p$ (вероятность отсутствия пути):
$
  alpha q^3 = alpha - (1-q) = alpha - 1 + q
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Кубическое уравнение:*
  
  $ alpha q^3 - q + (1 - alpha) = 0 $
]

= Решение кубического уравнения

== Поиск корней

*Очевидный корень:* $q = 1$ (то есть $p = 0$)

Проверка:
$
  alpha dot 1 - 1 + 1 - alpha = 0 quad checkmark
$

*Разложение:*

Поделим на $(q-1)$:
$
  alpha q^3 - q + (1-alpha) = (q-1)(alpha q^2 + alpha q + (alpha - 1))
$

Проверим раскрытием:
$
  (q-1)(alpha q^2 + alpha q + alpha - 1) = alpha q^3 + alpha q^2 + (alpha-1)q - alpha q^2 - alpha q - (alpha-1)
$
$
  = alpha q^3 + (alpha - 1 - alpha)q - (alpha - 1) = alpha q^3 - q + (1-alpha) quad checkmark
$

== Квадратное уравнение

Решаем $alpha q^2 + alpha q + (alpha - 1) = 0$:

$
  q^2 + q + (alpha - 1)/alpha = 0 arrow.r.double
  q^2 + q + 1 - 1/alpha = 0
$

Дискриминант:
$
  D = 1 - 4(1 - 1/alpha) = 1 - 4 + 4/alpha = 4/alpha - 3
$

Корни:
$
  q = (-1 plus.minus sqrt(4/alpha - 3))/2
$

Для действительных корней: $4/alpha - 3 >= 0$, то есть $alpha <= 4/3$.

Так как $alpha in [0, 1]$, условие всегда выполнено.

== Переход к $p$

Так как $p = 1 - q$:

$
  p = 1 - q = 1 - (-1 plus.minus sqrt(4/alpha - 3))/2 = 1 + (1 plus.minus sqrt(4/alpha - 3))/2
$

$
  p = (2 + 1 plus.minus sqrt(4/alpha - 3))/2 = (3 plus.minus sqrt(4/alpha - 3))/2
$

*Два кандидата:*

$
  p_1 = (3 - sqrt(4/alpha - 3))/2
$

$
  p_2 = (3 + sqrt(4/alpha - 3))/2
$

Упростим, домножив на $sqrt(alpha)$:

$
  p_1 = (3 - sqrt((4-3alpha)/alpha))/2 = (3alpha - sqrt(alpha(4-3alpha)))/(2alpha)
$

$
  = (3alpha - sqrt(4alpha - 3alpha^2))/(2alpha)
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Формула для корня:*
  
  $ p = (3alpha - sqrt(4alpha - 3alpha^2))/(2alpha), quad alpha != 0 $
]
== Критическая точка

Найдём, когда $p = 0$:

$
  0 = (3alpha - sqrt(4alpha - 3alpha^2))/(2alpha)
$

$
  3alpha = sqrt(4alpha - 3alpha^2)
$

$
  9alpha^2 = 4alpha - 3alpha^2
$

$
  12alpha^2 = 4alpha
$

$
  3alpha = 1 quad arrow.r.double quad alpha = 1/3
$


= Итоговая формула

#box(
  width: 100%,
  fill: rgb("#e8f4f8"),
  inset: 15pt,
  radius: 4pt,
)[
  #align(center)[
    *Вероятность существования бесконечного пути:*
  ]
  
  $ p(alpha) = cases(
    0 & "при" alpha in [0; space 1/3],
    
    (3alpha - sqrt(4alpha - 3alpha^2))/(2alpha) & "при" alpha in (1/3; space 1]
  ) $
]

= Проверка для конкретных значений

== Исходная задача: $alpha = 1/3$

$
  p(1/3) = 0
$

При критическом значении путь не существует (граница фазового перехода).

== Случай $alpha = 2/3$

$
  p(2/3) = (3 dot 2/3 - sqrt(4 dot 2/3 - 3 dot 4/9))/(2 dot 2/3)
$

$
  = (2 - sqrt(8/3 - 4/3))/(4/3) = (2 - sqrt(4/3))/(4/3)
$

$
  = (2 - 2/sqrt(3))/(4/3) = 3/4 dot 2(1 - 1/sqrt(3))
$

$
  = 3/2(1 - sqrt(3)/3) = 3/2 - sqrt(3)/2
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *При $alpha = 2/3$:*
  
  $ p = (3 - sqrt(3))/2 approx 0.634 $
]



= График зависимости $p(alpha)$

#align(center)[
#box(
  width: 95%,
  fill: rgb("#f9f9f9"),
  inset: 15pt,
  radius: 4pt,
)[
#text(size: 10pt)[

```
p(α)
 1.0 ┤
     │
     │
 0.8 ┤
     │
     │                  ╭──╮
 0.6 ┤                ╭─╯  ╰─╮
     │              ╭─╯      ╰─╮
     │            ╭─╯          ╰─╮
 0.4 ┤          ╭─╯              ╰─╮
     │        ╭─╯                  ╰──╮
     │    ╭───╯                       ╰───
 0.2 ┤────╯
     │
     │
 0.0 ┼──────────────────────────────────────────── α
    0.0  0.2  0.4  0.6  0.8  1.0
         ↑                    ↑
        1/3               проблема
                          при α→1
```

*Ключевые точки:*

#table(
  columns: 2,
  stroke: 0.5pt,
  inset: 8pt,
  align: center,
  fill: (col, row) => if row == 0 { rgb("#e8f4f8") },
  
  [*$alpha$*], [*$p(alpha)$*],
  
  [$0$], [$1$ (все спят)],
  [$1/3$], [$0$ (критическая точка)],
  [$1/2$], [$(3-sqrt(5))/2 approx 0.382$],
  [$2/3$], [$(3-sqrt(3))/2 approx 0.634$],
  [$1$], [$0$ (все бодрствуют)],
)

]
]
]