#set document(title: "Метод первого шага и цена позиции")
#set page(paper: "a4", margin: 2cm)
#set text(lang: "ru", font: "New Computer Modern", size: 11pt)
#set par(justify: true, leading: 0.65em)
// #set heading(numbering: "1.")
#show selector(<nonumber>): set heading(numbering: none)

#align(center)[
  #text(size: 16pt, weight: "bold")[
    Метод первого шага и цена позиции
  ]
]

#v(1em)

= Задача 1: Игра с кубиком и шляпой 

== Условие задачи

Мы играем в игру с правильным кубиком, который можно бросать неограниченное количество раз, и шляпой. Рубли могут находиться в шляпе (*шр*) и в кармане (*кр*).

При каждом броске кубика происходит следующее:

#set align(center)
#table(
  columns: 2,
  stroke: 0.5pt,
  inset: 8pt,
  align: (center, left),
  fill: (col, row) => if row == 0 { rgb("#e8f4f8") },
  [*Результат броска*], [*Действие*], 
  [1], [+1 шр, играем дальше],
  [2], [+2 кр, играем дальше],
  [3], [+3 шр, играем дальше],
  [4], [Игра закончилась и берём шляпу],
  [5], [Деньги сгорают и играем дальше],
  [6], [Деньги сгорают и конец игры]
)

#set align(left)

#v(0.5em)

*Требуется найти:* $EE(X)$ и $"Var"(X)$, где случайная величина $X$ — это выигрыш в данной игре.

= Решение

Для решения данной задачи необходимы две ключевые концепции:

#box(
  width: 100%,
  fill: rgb("#f0f0f0"),
  inset: 10pt,
  radius: 4pt,
)[
  *1. Метод первого шага* — анализируем, что произойдёт после первого броска кубика
  
  *2. Цена позиции* — каждому состоянию игры сопоставляем ожидаемый выигрыш

  *3. Индикатор* - иногда удобно что-то записать как индикатор, $R \in \{0, 1\}$
]

== Цена позиции

Пусть $s$ — количество денег в шляпе. Это наша *позиция в игре*.

Определим $v(s)$ — *цену позиции* $s$, то есть математическое ожидание выигрыша, если в шляпе сейчас $s$ рублей.

Наша цель: найти $v(0)$, так как игра начинается с пустой шляпы.

== Уравнение для цены позиции

Рассмотрим, что может произойти после *первого* броска кубика из позиции $s$:

#table(
  columns: 3,
  stroke: 0.5pt,
  inset: 8pt,
  align: (center, left, center),
  fill: (col, row) => if row == 0 { rgb("#e8f4f8") },
  [*Выпало*], [*Что происходит*], [*Вероятность*],
  
  [1], [В шляпе становится $s+1$ рубль, игра продолжается → выигрыш $v(s+1)$], [$1/6$],
  
  [2], [Получаем 2 рубля в карман + продолжаем с позиции $s$ → выигрыш $v(s) + 2$], [$1/6$],
  
  [3], [В шляпе становится $s+3$ рубля, игра продолжается → выигрыш $v(s+3)$], [$1/6$],
  
  [4], [Забираем шляпу → выигрыш $s$], [$1/6$],
  
  [5], [Всё сгорает, продолжаем с 0 → выигрыш $v(0)$], [$1/6$],
  
  [6], [Всё сгорает, игра заканчивается → выигрыш $0$], [$1/6$],
)

#v(0.5em)

По формуле полной вероятности:

$
  v(s) = 1/6 v(s + 1) + 1/6 (v(s) + 2) + 1/6 v(s+3) + 1/6 s + 1/6 v(0) + 1/6 dot 0
$

=== Упростим:


$
  6v(s) = v(s+1) + v(s) + 2 + v(s+3) + s + v(0) + 0
$


$
  5v(s) = v(s+1) + v(s+3) + s + 2 + v(0)
$

Это *рекуррентное соотношение* для функции $v(s)$.

== Поиск явного вида функции $v(s)$

#box(
  width: 100%,
  fill: rgb("#fff4e6"),
  inset: 10pt,
  radius: 4pt,
)[
  Функция $v(s)$ должна быть *аддитивной* по рублям в шляпе. Каждый дополнительный рубль в шляпе добавляет одинаковую ценность независимо от того, сколько там уже денег.

#set align(center)

#table(
  columns: 2,
  [На старте $s_0 = 0$], [На старте $s_0 != 0$], 
  [Выпадает последовательность $3,  4$],[Выпадает последовательность $3, 4$], 
  [$X$], [$X' + s_0 R$], 
  [$EE(X)$], [$EE(X')+s EE(R)$]
)
#set align(left)


  Это наводит на мысль, что $v(s)$ — *линейная функция*: $v(s) = alpha s + beta$
]

#v(0.5em)

Подставим $v(s) = alpha s + beta$ в уравнение:

$
  5(alpha s + beta) = alpha(s+1) + beta + alpha(s+3) + beta + s + 2 + (alpha dot 0 + beta)
$

Раскроем скобки:

$
  5 alpha s + 5 beta = alpha s + alpha + beta + alpha s + 3 alpha + beta + s + 2 + beta
$

$
  5 alpha s + 5 beta = 2 alpha s + 4 alpha + s + 2 + 3 beta
$

=== Определим коэффициенты, сравнивая их при одинаковых степенях $s$:

Коэффициент при $s$:
$
  5 alpha = 2 alpha + 1 ==> 3 alpha = 1 ==> alpha = 1/3
$

Свободный член:
$
  5 beta = 4 alpha + 2 + 3 beta = 4 dot 1/3 + 2 + 3 beta = 4/3 + 2 + 3 beta
$

$
  2 beta = 4/3 + 6/3 = 10/3 ==> beta = 5/3
$

=== Итоговая формула для цены позиции

$
  v(s) = 1/3 s + 5/3 = (s + 5)/3
$
Здесь $alpha$ является платой за начало игры с 0 монет в шляпе,а $beta$ в свою очередь выступает в роли обменного курса, то есть 1 рубль в шляпе приравнивается к $1/3$ рубля в карман. Это связано с вероятностью $1/6$ забрать шляпу (выпадение 4) и вероятностью $2/6$ всё потерять (выпадение 5 или 6).

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Ответ для математического ожидания:*
  
  $ EE(X) = v(0) = (0 + 5)/3 = 5/3 ≈ 1.67 "рублей" $
]



Чтобы убедиться, что в расчетах нет ошибки, можем проверить подставив в формулу полной вероятности $s = 0$:

$
  5 v(0) &= v(1) + v(3) + 0 + 2 + v(0) \
  5 dot 5/3 &= 6/3 + 8/3 + 2 + 5/3 \
  25/3 &= (6 + 8 + 5)/3 + 2 = 19/3 + 6/3 = 25/3 quad checkmark
$

= Нахождение дисперсии

== Уравнение для второго момента

Для вычисления дисперсии нам нужен второй момент: $EE(X^2)$.

Определим $w(s) = EE(X^2 | "начинаем с" s "рублей в шляпе")$.

Рассмотрим, что происходит с $X^2$ после первого броска:

#table(
  columns: 3,
  stroke: 0.5pt,
  inset: 8pt,
  align: (center, left, center),
  fill: (col, row) => if row == 0 { rgb("#e8f4f8") },
  [*Выпало*], [*Вклад в* $EE(X^2)$], [*Вероятность*],
  
  [1], [$w(s+1)$], [$1/6$],
  
  [2], [$(X+2)^2 = X^2 + 4X + 4$, то есть $w(s) + 4v(s) + 4$], [$1/6$],
  
  [3], [$w(s+3)$], [$1/6$],
  
  [4], [$s^2$], [$1/6$],
  
  [5], [$w(0)$], [$1/6$],
  
  [6], [$0$], [$1/6$],
)

#v(0.5em)

Получаем уравнение:

$
  w(s) = 1/6 w(s+1) + 1/6 (w(s) + 4v(s) + 4) + 1/6 w(s+3) + 1/6 s^2 + 1/6 w(0) + 0
$

Упрощаем:

$
  6w(s) = w(s+1) + w(s) + 4v(s) + 4 + w(s+3) + s^2 + w(0)
$

$
  5w(s) = w(s+1) + w(s+3) + 4v(s) + 4 + s^2 + w(0)
$

Подставляем $v(s) = (s+5)/3$:

$
  5w(s) = w(s+1) + w(s+3) + (4s + 20)/3 + 4 + s^2 + w(0)
$

$
  5w(s) = w(s+1) + w(s+3) + (4s + 32)/3 + s^2 + w(0)
$

=== Найдем квадратичную функцию

Предположим $w(s) = a s^2 + b s + c$, где $w(0) = c$

Подставляем:

$
  5(a s^2 + b s + c) = a(s+1)^2 + b(s+1) + c + a(s+3)^2 + b(s+3) + c + (4s+32)/3 + s^2 + c
$

Раскрываем:

$
  5a s^2 + 5b s + 5c = a s^2 + 2a s + a + b s + b + a s^2 + 6a s + 9a + b s + 3b + (4s)/3 + 32/3 + s^2 + 3c
$

$
  5a s^2 + 5b s + 5c = (2a + 1)s^2 + (8a + 2b + 4/3)s + (10a + 4b + 32/3 + 3c)
$

*Коэффициент при* $s^2$:
$
  5a = 2a + 1 ==> 3a = 1 ==> a = 1/3
$

*Коэффициент при* $s$:
$
  5b = 8a + 2b + 4/3 = 8/3 + 2b + 4/3 = 4 + 2b ==> 3b = 4 ==> b = 4/3
$

*Свободный член:*
$
  5c = 10a + 4b + 32/3 + 3c = 10/3 + 16/3 + 32/3 + 3c = 58/3 + 3c
$

$
  2c = 58/3 ==> c = 29/3
$

== Итоговая формула для второго момента

$
  w(s) = 1/3 s^2 + 4/3 s + 29/3 = (s^2 + 4s + 29)/3
$

$
  EE(X^2) = w(0) = 29/3
$

=== Вычисление дисперсии

$
  "Var"(X) = EE(X^2) - (EE(X))^2 = 29/3 - (5/3)^2 = 29/3 - 25/9
$

$
  "Var"(X) = 87/9 - 25/9 = 62/9 ≈ 6.89
$

= Итоговый ответ

#box(
  width: 100%,
  fill: rgb("#e8f4f8"),
  inset: 15pt,
  radius: 4pt,
)[
  #align(center)[
    *Математическое ожидание выигрыша:*
    
    $ EE(X) = 5/3 ≈ 1.67 "рублей" $
    
    *Дисперсия выигрыша:*
    
    $ "Var"(X) = 62/9 ≈ 6.89 "рублей"^2 $
    
    *Среднеквадратичное отклонение:*
    
    $ sigma(X) = sqrt(62/9) = sqrt(62)/3 ≈ 2.62 "рубля" $
  ]
]
#v(1em)

#align(center)[
  #box(
    width: 90%,
    fill: rgb("#fff4e6"),
    inset: 10pt,
    radius: 4pt,
  )[
    Метод первого шага позволяет свести сложную задачу к системе рекуррентных уравнений. Предположение о виде решения (линейная или квадратичная функция) позволяет найти явные формулы для всех характеристик случайной величины.
  ]
]

#pagebreak()

#v(1em)
= Задача 2: Лучшее пари для простаков

== Условие задачи

Правильную монетку подбрасывают бесконечное число раз. Обозначим:
- $H$ — орёл (heads)
- $T$ — решка (tails)

Два игрока $A$ и $B$ ожидают появления своих комбинаций:
- Игрок $A$ ждёт последовательность $H T T$
- Игрок $B$ ждёт последовательность $T T H$

Игра заканчивается, когда один из игроков дожидается своей комбинации.

Обозначим:
- $X_{H T T}$ — момент времени, когда впервые выпала последовательность $H T T$
- $X_{T T H}$ — момент времени, когда впервые выпала последовательность $T T H$

*Требуется найти:*

1. $P(X_{H T T} < X_{T T H})$ — вероятность выигрыша игрока $A$

2. $EE(X_{H T T})$, $EE(X_{T T H})$, $EE(X_{H T H})$ — математические ожидания времён появления последовательностей

#v(1em)

#box(
  width: 100%,
  fill: rgb("#fff4e6"),
  inset: 10pt,
  radius: 4pt,
)[
  *Ключевое наблюдение:* Позиция в игре определяется не более чем *двумя последними символами* в последовательности бросков. Это позволяет построить конечное дерево состояний.
]

= Часть 1: Вероятность $P(X_{H T T} < X_{T T H})$


#align(center)[
#box(
  width: 100%,
  fill: rgb("#f9f9f9"),
  inset: 15pt,
  radius: 4pt,
)[
  #text(size: 10pt)[
*Дерево состояний для соревнования $H T T$ vs $T T H$*

#v(0.5em)

```
                    ∅ (начало)
                   / \
                 /      \
            (H) H        T (T)
              / \       / \
            /     \   /     \
          HH      HT TH      TT
          |      / |  |      | \
          |     /  |[цикл]   |   \
      [цикл]  HTT HTH -> H [цикл] TTH
      -> H    (A) ->TH     ->T    (B)

Легенда:
• HTT — игрок A выигрывает
• TTH — игрок B выигрывает
• [цикл] — состояние может вернуться в себя
• Вероятность каждого перехода = 1/2
```

#v(0.5em)

Асимметрия циклов для H создаёт преимущество для последовательности $H T T$

  ]
]
]

== Диаграмма переходов

Пусть $p_s$ — вероятность того, что игрок $A$ выиграет, начиная из состояния $s$

Переходы между состояниями при бросках монеты (каждый с вероятностью $1/2$):

#align(center)[
#box(
  width: 95%,
  fill: rgb("#f8f8f8"),
  inset: 12pt,
  radius: 4pt,
)[
  #text(size: 9pt)[
#table(
  columns: 5,
  stroke: 0.5pt,
  inset: 6pt,
  align: center,
  fill: (col, row) => if row == 0 { rgb("#e8f4f8") },
  [*Из состояния*], [*Выпало $H$*], [*Выпало $T$*], [*Примечание*], [*$p$ состояния*],
  
  [$∅$], [$H$], [$T$], [Начало], $p_∅ &= 1/2 p_H + 1/2 p_T$,
  [$H$], [$H H$], [$H T$], [], $p_H &= 1/2 p_{H H} + 1/2 p_{H T}$,
  [$T$], [$T H$], [$T T$], [], $p_T &= 1/2 p_{T H} + 1/2 p_{T T}$,
  [$H H$], [$H H$], [$H T$], [После $H H + H$ снова $H H$], $p_{H H} &= 1/2 p_{H H} + 1/2 p_{H T}$,
  [$H T$], [$T H$], [$bold(H T T)$], [#text(fill: red)[*A выиграл!*]], $p_{H T} &= 1/2 p_{T H} + 1/2 dot 1$,
  [$T H$], [$H H$], [$T T$], [], $p_{T H} &= 1/2 p_{H H} + 1/2 p_{T T}$,
  [$T T$], [$bold(T T H)$], [$T T$], [#text(fill: blue)[*B выиграл!*]], $p_{T T} &= 1/2 dot 0 + 1/2 p_{T T}$,
)
  ]
]
]


== Система уравнений для вероятности выигрыша $A$

*Граничные условия:*
$
  p_{H T T} = 1, quad p_{T T H} = 0
$

== Решение системы

$
  p_{T T} = 1/2 p_{T T} quad ==> quad p_{T T} = 0 quad quad 
  p_{T H} = 1/2 p_{H H} + 1/2 dot 0 = 1/2 p_{H H}
$
$
  p_{H T} = 1/2 p_{T H} + 1/2 quad quad 
  p_{H H} = 1/2 p_{H H} + 1/2 p_{H T}
$

$
  1/2 p_{H H} = 1/2 p_{H T} quad ==> quad p_{H H} = p_{H T}
$

Подставим:
$
  p_{H T} = 1/2 dot 1/2 p_{H H} + 1/2 = 1/4 p_{H T} + 1/2
$

$
  3/4 p_{H T} = 1/2 quad ==> quad p_{H T} = 2/3
$
Следовательно:
$
  p_{H H} = 2/3, quad p_{T H} = 1/3, quad p_{T T} = 0
$

*Находим* $p_H$ и $p_T$:
$
  p_H = 1/2 dot 2/3 + 1/2 dot 2/3 = 2/3
quad quad quad 
  p_T = 1/2 dot 1/3 + 1/2 dot 0 = 1/6
$

*Итоговая вероятность:*
$
  p_∅ = 1/2 dot 2/3 + 1/2 dot 1/6 = 1/3 + 1/12 = 4/12 + 1/12 = 5/12
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 15pt,
  radius: 4pt,
)[
  #align(center)[
    *Ответ:*
    
    $ P(X_{H T T} < X_{T T H}) = 5/12 ≈ 0.417 $
    
    Игрок $A$ (ожидающий $H T T$) выигрывает с вероятностью примерно *41.7%*
    
    Игрок $B$ (ожидающий $T T H$) выигрывает с вероятностью $7/12 ≈$ *58.3%*
  ]
]

= Часть 2: Математические ожидания времён появления

== Задача 2.1: Нахождение $EE(X_{H T T})$

Пусть $v_s$ — математическое ожидание времени до появления $H T T$, если мы начинаем из состояния $s$.

*Метод первого шага:*

На каждом шаге тратится 1 бросок, затем переходим в новое состояние:

$
  v_∅ &= 1 + 1/2 v_H + 1/2 v_T \
  v_H &= 1 + 1/2 v_{H H} + 1/2 v_{H T} \
  v_T &= 1 + 1/2 v_{T H} + 1/2 v_{T T} \
  v_{H H} &= 1 + 1/2 v_{H H} + 1/2 v_{H T} \
  v_{H T} &= 1 + 1/2 v_{T H} + 1/2 dot 0 \
  v_{T H} &= 1 + 1/2 v_{H H} + 1/2 v_{T T} \
  v_{T T} &= 1 + 1/2 v_{T H} + 1/2 v_{T T}
$

*Решение:*

Из $v_{H T}$:
$
  v_{H T} = 1 + 1/2 v_{T H}
$

Из $v_{H H}$:
$
  v_{H H} = 1 + 1/2 v_{H H} + 1/2 v_{H T}
$
$
  1/2 v_{H H} = 1 + 1/2 v_{H T} quad ==> quad v_{H H} = 2 + v_{H T}
$

Из $v_{T T}$:
$
  v_{T T} = 1 + 1/2 v_{T H} + 1/2 v_{T T}
$
$
  1/2 v_{T T} = 1 + 1/2 v_{T H} quad ==> quad v_{T T} = 2 + v_{T H}
$

Из $v_{T H}$:
$
  v_{T H} = 1 + 1/2 v_{H H} + 1/2 v_{T T}
$
$
  v_{T H} = 1 + 1/2(2 + v_{H T}) + 1/2(2 + v_{T H})
$
$
  v_{T H} = 1 + 1 + 1/2 v_{H T} + 1 + 1/2 v_{T H}
$
$
  1/2 v_{T H} = 3 + 1/2 v_{H T} quad ==> quad v_{T H} = 6 + v_{H T}
$

Подставляем в $v_{H T}$:
$
  v_{H T} = 1 + 1/2(6 + v_{H T}) = 1 + 3 + 1/2 v_{H T}
$
$
  1/2 v_{H T} = 4 quad ==> quad v_{H T} = 8
$

*Обратная подстановка:*
$
  v_{T H} &= 6 + 8 = 14 \
  v_{H H} &= 2 + 8 = 10 \
  v_{T T} &= 2 + 14 = 16
$

$
  v_H = 1 + 1/2 dot 10 + 1/2 dot 8 = 1 + 5 + 4 = 10
$
$
  v_T = 1 + 1/2 dot 14 + 1/2 dot 16 = 1 + 7 + 8 = 16
$
$
  v_∅ = 1 + 1/2 dot 10 + 1/2 dot 16 = 1 + 5 + 8 = 14
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Математическое ожидание времени появления* $H T T$:
  
  $ EE(X_{H T T}) = 14 "бросков" $
]

== Задача 2.2: Нахождение $EE(X_{T T H})$

Пусть $w_s$ — математическое ожидание времени до появления $T T H$ из состояния $s$.

*Система уравнений:*

$
  w_∅ &= 1 + 1/2 w_H + 1/2 w_T \
  w_H &= 1 + 1/2 w_{H H} + 1/2 w_{H T} \
  w_T &= 1 + 1/2 w_{T H} + 1/2 w_{T T} \
  w_{H H} &= 1 + 1/2 w_{H H} + 1/2 w_{H T} \
  w_{H T} &= 1 + 1/2 w_{T H} + 1/2 w_{T T} \
  w_{T H} &= 1 + 1/2 w_{H H} + 1/2 w_{T T} \
  w_{T T} &= 1 + 1/2 dot 0 + 1/2 w_{T T}
$

*Решение:*

Из $w_{T T}$:
$
  w_{T T} = 1 + 1/2 w_{T T} quad ==> quad w_{T T} = 2
$

Из $w_{H H}$:
$
  w_{H H} = 1 + 1/2 w_{H H} + 1/2 w_{H T} quad ==> quad w_{H H} = 2 + w_{H T}
$

Из $w_{H T}$:
$
  w_{H T} = 1 + 1/2 w_{T H} + 1/2 dot 2 = 2 + 1/2 w_{T H}
$

Из $w_{T H}$:
$
  w_{T H} = 1 + 1/2 w_{H H} + 1/2 dot 2 = 2 + 1/2 w_{H H}
$

*Подставляем:*
$
  w_{H T} = 2 + 1/2(2 + 1/2 w_{H H}) = 2 + 1 + 1/4 w_{H H} = 3 + 1/4 w_{H H}
$

$
  w_{H H} = 2 + w_{H T} = 2 + 3 + 1/4 w_{H H} = 5 + 1/4 w_{H H}
$

$
  3/4 w_{H H} = 5 quad ==> quad w_{H H} = 20/3
$

*Обратная подстановка:*
$
  w_{H T} &= 3 + 1/4 dot 20/3 = 3 + 5/3 = 14/3 \
  w_{T H} &= 2 + 1/2 dot 20/3 = 2 + 10/3 = 16/3
$

$
  w_H = 1 + 1/2 dot 20/3 + 1/2 dot 14/3 = 1 + 10/3 + 7/3 = 1 + 17/3 = 20/3
$

$
  w_T = 1 + 1/2 dot 16/3 + 1/2 dot 2 = 1 + 8/3 + 1 = 2 + 8/3 = 14/3
$

$
  w_∅ = 1 + 1/2 dot 20/3 + 1/2 dot 14/3 = 1 + 10/3 + 7/3 = 20/3
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Математическое ожидание времени появления* $T T H$:
  
  $ EE(X_{T T H}) = 20/3 ≈ 6.67 "бросков" $
]

== Задача 2.3: Нахождение $EE(X_{H T H})$

Для последовательности $H T H$ построим аналогичную систему.

*Переходы:*
- $H T + H → H T H$ (конец)
- $H T + T → T T$ (последние два символа)

*Система уравнений:*

$
  u_∅ &= 1 + 1/2 u_H + 1/2 u_T \
  u_H &= 1 + 1/2 u_{H H} + 1/2 u_{H T} \
  u_T &= 1 + 1/2 u_{T H} + 1/2 u_{T T} \
  u_{H H} &= 1 + 1/2 u_{H H} + 1/2 u_{H T} \
  u_{H T} &= 1 + 1/2 dot 0 + 1/2 u_{T T} \
  u_{T H} &= 1 + 1/2 u_{H H} + 1/2 u_{T T} \
  u_{T T} &= 1 + 1/2 u_{T H} + 1/2 u_{T T}
$

*Решение:*

Из $u_{H T}$:
$
  u_{H T} = 1 + 1/2 u_{T T}
$

Из $u_{H H}$:
$
  u_{H H} = 2 + u_{H T} = 2 + 1 + 1/2 u_{T T} = 3 + 1/2 u_{T T}
$

Из $u_{T T}$:
$
  u_{T T} = 1 + 1/2 u_{T H} + 1/2 u_{T T} quad ==> quad u_{T T} = 2 + u_{T H}
$

Из $u_{T H}$:
$
  u_{T H} = 1 + 1/2 u_{H H} + 1/2 u_{T T}
$
$
  u_{T H} = 1 + 1/2(3 + 1/2 u_{T T}) + 1/2 u_{T T}
$
$
  u_{T H} = 1 + 3/2 + 1/4 u_{T T} + 1/2 u_{T T} = 5/2 + 3/4 u_{T T}
$

*Подставляем в* $u_{T T}$:
$
  u_{T T} = 2 + 5/2 + 3/4 u_{T T}
$
$
  1/4 u_{T T} = 9/2 quad ==> quad u_{T T} = 18
$

*Обратная подстановка:*
$
  u_{T H} &= 5/2 + 3/4 dot 18 = 5/2 + 27/2 = 16 \
  u_{H T} &= 1 + 1/2 dot 18 = 10 \
  u_{H H} &= 3 + 1/2 dot 18 = 12
$

$
  u_H = 1 + 1/2 dot 12 + 1/2 dot 10 = 1 + 6 + 5 = 12
$

$
  u_T = 1 + 1/2 dot 16 + 1/2 dot 18 = 1 + 8 + 9 = 18
$

$
  u_∅ = 1 + 1/2 dot 12 + 1/2 dot 18 = 1 + 6 + 9 = 16
$

#box(
  width: 100%,
  fill: rgb("#e8f8e8"),
  inset: 10pt,
  radius: 4pt,
)[
  *Математическое ожидание времени появления* $H T H$:
  
  $ EE(X_{H T H}) = 16 "бросков" $
]

#v(1em)

#align(center)[
  #box(
    width: 90%,
    fill: rgb("#fff4e6"),
    inset: 12pt,
    radius: 4pt,
  )[
    *Практический вывод:* В пари на появление последовательностей выбор правильной комбинации критически важен! Последовательности с повторяющимися символами ($T T H$) имеют преимущество над последовательностями без повторений в начале ($H T T$), так как они могут "перезапускаться" эффективнее при неудачных бросках.
    
    Это классический пример *нетранзитивности* в вероятностных играх: даже "равные" последовательности могут иметь разные шансы на победу в соревновании!
  ]
]
